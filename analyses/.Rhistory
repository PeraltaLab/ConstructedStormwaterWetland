if(Sys.info()[1] == "Darwin"){
setwd("~/Desktop/ConstructedStormwaterWetland/analyses/")
} else {
# setwd(choose.dir())
}
rm(list = ls())
library(ggplot2)
library(psych)
#GHG Flux data
ghg <- read.csv("../data/CSW_GHG_Env.csv", header=T)
#sets plots for 2 rows, 2 columns
par(mfcol=c(2,2))
#linear models for CH4
g1<- lm(log(ch4.mgm2hr)~soiltemp*hydrology*placement*season, data=ghg)
plot(g1)
anova(g1)
#linear models for CH4
ch4 <- lm(log(ch4.mgm2hr)~soiltemp*hydrology*placement, data=ghg)
plot(ch4)
anova(ch4)
#linear models for CH4
ch4.lm <- lm(log(ch4.mgm2hr)~soiltemp*hydrology*placement, data=ghg)
plot(ch4.lm)
anova(ch4.lm)
p <- ggplot(ghg, aes(x=soiltemp, y=ch4.mgm2hr, color=as.factor(hydrology))) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor =element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "black",size=1)) + stat_summary(fun.data=mean_cl_boot,size=1.25, position=position_dodge(width=0.75))
p
p <- ggplot(ghg, aes(x=soiltemp, y=log(ch4.mgm2hr), color=as.factor(hydrology))) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor =element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "black",size=1)) + stat_summary(fun.data=mean_cl_boot,size=1.25, position=position_dodge(width=0.75))
p
p <- ggplot(ghg, aes(x=soiltemp, y=log(ch4.mgm2hr), shape=as.factor(placement), color=as.factor(hydrology))) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor =element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "black",size=1)) + stat_summary(fun.data=mean_cl_boot,size=1.25, position=position_dodge(width=0.75))
p
p <- ggplot(ghg, aes(x=soiltemp, y=log(ch4.mgm2hr), color=as.factor(hydrology))) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor =element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "black",size=1)) + stat_summary(fun.data=mean_cl_boot,size=1.25, position=position_dodge(width=0.75))
p1=p+geom_smooth(method="lm")+facet_wrap(~placement)
p1
#sets plots for 1 rows, 4 columns
par(mfcol=c(1,4))
#linear models for CH4
ch4.lm <- lm(log(ch4.mgm2hr)~soiltemp*hydrology*placement, data=ghg)
plot(ch4.lm)
anova(ch4.lm)
p <- ggplot(ghg, aes(x=soiltemp, y=log(ch4.mgm2hr), color=as.factor(hydrology))) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor =element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "black",size=1)) + stat_summary(fun.data=mean_cl_boot,size=1.25, position=position_dodge(width=0.75))
p1=p+geom_smooth(method="lm")+facet_wrap(~placement)
p1
#extra info for graphing
library(scales)
fancy_scientific <- function(l) {
# turn in to character string in scientific notation
l <- format(l, scientific = TRUE)
# quote the part before the exponent to keep all the digits
l <- gsub("^(.*)e", "'\\1'e", l)
# turn the 'e+' into plotmath format
l <- gsub("e", "%*%10^", l)
# return this as an expression
parse(text=l)
} #scale_y_continuous(labels=fancy_scientific)
fmt_decimals <- function(decimals=0){
function(x) format(x,nsmall = decimals,scientific = FALSE)
} #scale_y_continuous(labels = fmt_decimals(2))
#sets plots for 1 rows, 4 columns
par(mfcol=c(1,4))
#linear models for CH4
ch4.lm <- lm(log(ch4.mgm2hr)~soiltemp*hydrology*placement, data=ghg)
plot(ch4.lm)
anova(ch4.lm)
p <- ggplot(ghg, aes(x=soiltemp, y=log(ch4.mgm2hr), color=as.factor(hydrology))) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor =element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "black",size=1)) + stat_summary(fun.data=mean_cl_boot,size=1.25, position=position_dodge(width=0.75))
p1=p+geom_smooth(method="lm")+facet_wrap(~placement)
p1
p1+scale_color_manual(name="Hydrology", values=c("black", "purple"), labels = c("shallow (t)", "inundated (w)")) + labs(x = "Soil Temperature (°C) ", y =  (expression(paste("CO"[2]," flux (mg m"^-{2},"hr"^-{1},")"))))") +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14))
p <- ggplot(ghg, aes(x=soiltemp, y=log(ch4.mgm2hr), color=as.factor(hydrology))) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor =element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "black",size=1)) + scale_color_manual(name="Hydrology", values=c("black", "purple"), labels = c("shallow (t)", "inundated (w)")) + stat_summary(fun.data=mean_cl_boot,size=1.25, position=position_dodge(width=0.75))
p
p <- ggplot(ghg, aes(x=soiltemp, y=log(ch4.mgm2hr), color=as.factor(hydrology))) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor =element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "black",size=1)) + scale_color_manual(name="Hydrology", values=c("black", "blue"), labels = c("shallow (t)", "inundated (w)")) + stat_summary(fun.data=mean_cl_boot,size=1.25, position=position_dodge(width=0.75))
p
p <- ggplot(ghg, aes(x=soiltemp, y=log(ch4.mgm2hr), color=as.factor(hydrology))) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor =element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "black",size=1)) + scale_color_manual(name="Hydrology", values=c("gray", "blue"), labels = c("shallow (t)", "inundated (w)")) + stat_summary(fun.data=mean_cl_boot,size=1.25, position=position_dodge(width=0.75))
p
p <- ggplot(ghg, aes(x=soiltemp, y=log(ch4.mgm2hr), color=as.factor(hydrology))) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor =element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "black",size=1)) + scale_color_manual(name="Hydrology", values=c("darkgray", "blue"), labels = c("shallow (t)", "inundated (w)")) + stat_summary(fun.data=mean_cl_boot,size=1.25, position=position_dodge(width=0.75))
p
p1=p+geom_smooth(method="lm")+facet_wrap(~placement)
p1
p1 + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, size=14), panel.border = element_rect(colour = "black",size=1)) + theme(axis.ticks.length=unit(0.3,"cm"))
p1 + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, size=14), panel.border = element_rect(colour = "black",size=1)) + theme(axis.ticks.length=unit(0.3,"cm")) + labs(x = "Soil Temperature (°C) ", y =  (expression(paste("CO"[2]," flux (mg m"^-{2},"hr"^-{1},")
p1 + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, size=14), panel.border = element_rect(colour = "black",size=1)) + theme(axis.ticks.length=unit(0.3,"cm")) + labs(x = "Soil Temperature (°C) ", y =  (expression(paste("CO"[2]," flux (mg m"^-{2},"hr"^-{1},") + theme(strip.text.x = element_text(size=16, face="bold"), strip.text.y = element_text(size=16, face="bold"), strip.background = element_rect(colour="black", fill="white", size=1))
p1 + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, size=14), panel.border = element_rect(colour = "black",size=1)) + theme(axis.ticks.length=unit(0.3,"cm")) + labs(x = "Soil Temperature (°C) ", y =  (expression(paste("CO"[2]," flux (mg m"^-{2},"hr"^-{1}"))))
p1 + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, size=14), panel.border = element_rect(colour = "black",size=1)) + theme(axis.ticks.length=unit(0.3,"cm")) + labs(x = "Soil Temperature (°C) ", y =  (expression(paste("CO"[2]," flux (µg m"^-{2},"hr"^-{1},")"))))
p1 + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, size=14), panel.border = element_rect(colour = "black",size=1)) + theme(axis.ticks.length=unit(0.3,"cm"))
p1 + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, size=14), panel.border = element_rect(colour = "black",size=1)) + theme(axis.ticks.length=unit(0.3,"cm")) + labs(x = "Soil Temperature (°C) ")
p1 + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, size=14), panel.border = element_rect(colour = "black",size=1)) + theme(axis.ticks.length=unit(0.3,"cm")) + labs(x = "Soil Temperature (°C) ", y =  (expression(paste("CO"[2]," flux (µg m"^-{2},"hr"^-{1},")"))))
p1 + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, size=14), panel.border = element_rect(colour = "black",size=1)) + theme(axis.ticks.length=unit(0.3,"cm")) + labs(x = "Soil Temperature (°C) ", y =  (expression(paste("CH"[4]," flux (mg m"^-{2},"hr"^-{1},")"))))
p1 + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, size=14), panel.border = element_rect(colour = "black",size=1)) + theme(axis.ticks.length=unit(0.3,"cm")) + labs(x = "Soil Temperature (°C) ", y =  (expression(paste("CH"[4]," flux (mg m"^-{2},"hr"^-{1},")")))) + theme(strip.text.x = element_text(size=16, face="bold"), strip.text.y = element_text(size=16, face="bold"), strip.background = element_rect(colour="black", fill="white", size=1))
p1 + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, size=14), panel.border = element_rect(colour = "black",size=1)) + theme(axis.ticks.length=unit(0.3,"cm")) + labs(x = "Soil Temperature (°C) ", y =  (expression(paste("CH"[4]," flux (mg m"^-{2},"hr"^-{1},")")))) + theme(strip.text.x = element_text(size=16, face="bold"), strip.text.y = element_text(size=16, face="bold"), strip.background = element_rect(colour="black", fill="white", size=1))+theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14))
ggsave("../figures/methane.pdf", plot=last_plot(), device=NULL, path=NULL, scale=1, width=NA, height=NA, dpi=300, limitsize=TRUE)
#sets plots for 1 rows, 4 columns
par(mfcol=c(1,4))
p <- ggplot(ghg, aes(x=soiltemp, y=log(ch4.mgm2hr), color=as.factor(hydrology))) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor =element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "black",size=1)) + scale_color_manual(name="Hydrology", values=c("darkgray", "blue"), labels = c("shallow (t)", "inundated (w)")) + stat_summary(fun.data=mean_cl_boot,size=1.25, position=position_dodge(width=0.75))
p1=p+geom_smooth(method="lm")+facet_wrap(~placement)
p1 + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, size=14), panel.border = element_rect(colour = "black",size=1)) + theme(axis.ticks.length=unit(0.3,"cm")) + labs(x = "Soil Temperature (°C) ", y =  (expression(paste("CH"[4]," flux (mg m"^-{2},"hr"^-{1},")")))) + theme(strip.text.x = element_text(size=16, face="bold"), strip.text.y = element_text(size=16, face="bold"), strip.background = element_rect(colour="black", fill="white", size=1))+theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14))
#sets plots for 1 rows, 4 columns
par(mfcol=c(1,3))
#linear models for CH4
ch4.lm <- lm(log(ch4.mgm2hr)~soiltemp*hydrology*placement, data=ghg)
plot(ch4.lm)
p1=p+geom_smooth(method="lm")+facet_wrap(~placement)
p1 + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, size=14), panel.border = element_rect(colour = "black",size=1)) + theme(axis.ticks.length=unit(0.3,"cm")) + labs(x = "Soil Temperature (°C) ", y =  (expression(paste("CH"[4]," flux (mg m"^-{2},"hr"^-{1},")")))) + theme(strip.text.x = element_text(size=16, face="bold"), strip.text.y = element_text(size=16, face="bold"), strip.background = element_rect(colour="black", fill="white", size=1))+theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14))
p <- ggplot(ghg, aes(x=soiltemp, y=log(ch4.mgm2hr), color=as.factor(hydrology))) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor =element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "black",size=1)) + scale_color_manual(name="Hydrology", values=c("darkgray", "blue"), labels = c("shallow (t)", "inundated (w)")) + stat_summary(fun.data=mean_cl_boot,size=1.25, position=position_dodge(width=0.75))
p1=p+geom_smooth(method="lm")+facet_wrap(~placement,ncol = 3)
p1 + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, size=14), panel.border = element_rect(colour = "black",size=1)) + theme(axis.ticks.length=unit(0.3,"cm")) + labs(x = "Soil Temperature (°C) ", y =  (expression(paste("CH"[4]," flux (mg m"^-{2},"hr"^-{1},")")))) + theme(strip.text.x = element_text(size=16, face="bold"), strip.text.y = element_text(size=16, face="bold"), strip.background = element_rect(colour="black", fill="white", size=1))+theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14))
p <- ggplot(ghg, aes(x=soiltemp, y=log(ch4.mgm2hr), color=as.factor(hydrology))) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor =element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "black",size=1)) + scale_color_manual(name="Hydrology", values=c("darkgray", "blue"), labels = c("shallow (t)", "inundated (w)")) + stat_summary(fun.data=mean_cl_boot,size=1.25, position=position_dodge(width=0.75))
p1=p+geom_smooth(method="lm")+facet_wrap(~placement,ncol = 4)
p1 + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, size=14), panel.border = element_rect(colour = "black",size=1)) + theme(axis.ticks.length=unit(0.3,"cm")) + labs(x = "Soil Temperature (°C) ", y =  (expression(paste("CH"[4]," flux (mg m"^-{2},"hr"^-{1},")")))) + theme(strip.text.x = element_text(size=16, face="bold"), strip.text.y = element_text(size=16, face="bold"), strip.background = element_rect(colour="black", fill="white", size=1))+theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14))
ggsave("../figures/methane.pdf", plot=last_plot(), device=NULL, path=NULL, scale=1, width=NA, height=NA, dpi=300, limitsize=TRUE)
p <- ggplot(ghg, aes(x=soiltemp, y=log(ch4.mgm2hr), color=as.factor(hydrology))) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor =element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "black",size=1)) + scale_color_manual(name="Hydrology", values=c("darkgray", "blue"), labels = c("shallow (t)", "inundated (w)")) + stat_summary(fun.data=mean_cl_boot,size=1.25, position=position_dodge(width=0.75))
p1=p+geom_smooth(method="lm")+facet_wrap(~placement,nrow = 4)
p1 + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, size=14), panel.border = element_rect(colour = "black",size=1)) + theme(axis.ticks.length=unit(0.3,"cm")) + labs(x = "Soil Temperature (°C) ", y =  (expression(paste("CH"[4]," flux (mg m"^-{2},"hr"^-{1},")")))) + theme(strip.text.x = element_text(size=16, face="bold"), strip.text.y = element_text(size=16, face="bold"), strip.background = element_rect(colour="black", fill="white", size=1))+theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14))
ggsave("../figures/methane.pdf", plot=last_plot(), device=NULL, path=NULL, scale=1, width=NA, height=NA, dpi=300, limitsize=TRUE)
p <- ggplot(ghg, aes(x=soiltemp, y=log(ch4.mgm2hr), color=as.factor(hydrology))) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor =element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "black",size=1)) + scale_color_manual(name="Hydrology", values=c("darkgray", "blue"), labels = c("shallow (t)", "inundated (w)")) + stat_summary(fun.data=mean_cl_boot,size=1.25, position=position_dodge(width=0.75))
p1=p+geom_smooth(method="lm")+facet_wrap(~placement)
p1 + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, size=14), panel.border = element_rect(colour = "black",size=1)) + theme(axis.ticks.length=unit(0.3,"cm")) + labs(x = "Soil Temperature (°C) ", y =  (expression(paste("CH"[4]," flux (mg m"^-{2},"hr"^-{1},")")))) + theme(strip.text.x = element_text(size=16, face="bold"), strip.text.y = element_text(size=16, face="bold"), strip.background = element_rect(colour="black", fill="white", size=1))+theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14))
ggsave("../figures/methane.pdf", plot=last_plot(), device=NULL, path=NULL, scale=1, width=NA, height=NA, dpi=300, limitsize=TRUE)
p <- ggplot(ghg, aes(x=soiltemp, y=log(co2.mgm2hr), color=as.factor(hydrology))) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor =element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "black",size=1)) + scale_color_manual(name="Hydrology", values=c("darkgray", "blue"), labels = c("shallow (t)", "inundated (w)")) + stat_summary(fun.data=mean_cl_boot,size=1.25, position=position_dodge(width=0.75))
#linear models for CH4
co2.lm <- lm(log(co2.mgm2hr)~soiltemp*hydrology*placement, data=ghg)
plot(co2.lm)
p <- ggplot(ghg, aes(x=soiltemp, y=log(co2.mgm2hr), color=as.factor(hydrology))) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor =element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "black",size=1)) + scale_color_manual(name="Hydrology", values=c("darkgray", "blue"), labels = c("shallow (t)", "inundated (w)")) + stat_summary(fun.data=mean_cl_boot,size=1.25, position=position_dodge(width=0.75))
p1=p+geom_smooth(method="lm")+facet_wrap(~placement)
p1 + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, size=14), panel.border = element_rect(colour = "black",size=1)) + theme(axis.ticks.length=unit(0.3,"cm")) + labs(x = "Soil Temperature (°C) ", y =  (expression(paste("CO"[2]," flux (mg m"^-{2},"hr"^-{1},")")))) + theme(strip.text.x = element_text(size=16, face="bold"), strip.text.y = element_text(size=16, face="bold"), strip.background = element_rect(colour="black", fill="white", size=1))+theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14))
ggsave("../figures/carbondioxide.pdf", plot=last_plot(), device=NULL, path=NULL, scale=1, width=NA, height=NA, dpi=300, limitsize=TRUE)
p <- ggplot(ghg, aes(x=soiltemp, y=log(n2o.mgm2hr), color=as.factor(hydrology))) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor =element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "black",size=1)) + scale_color_manual(name="Hydrology", values=c("darkgray", "blue"), labels = c("shallow (t)", "inundated (w)")) + stat_summary(fun.data=mean_cl_boot,size=1.25, position=position_dodge(width=0.75))
p
p <- ggplot(ghg, aes(x=soiltemp, y=log(n2o.mgm2hr), color=as.factor(hydrology))) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor =element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "black",size=1)) + scale_color_manual(name="Hydrology", values=c("darkgray", "blue"), labels = c("shallow (t)", "inundated (w)")) + stat_summary(fun.data=mean_cl_boot,size=1.25, position=position_dodge(width=0.75))
p1=p+geom_smooth(method="lm")+facet_wrap(~placement)
p1 + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, size=14), panel.border = element_rect(colour = "black",size=1)) + theme(axis.ticks.length=unit(0.3,"cm")) + labs(x = "Soil Temperature (°C) ", y =  (expression(paste("N"[2],"O"," flux (mg m"^-{2},"hr"^-{1},")")))) + theme(strip.text.x = element_text(size=16, face="bold"), strip.text.y = element_text(size=16, face="bold"), strip.background = element_rect(colour="black", fill="white", size=1))+theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14))
ggsave("../figures/nitrousoxide.pdf", plot=last_plot(), device=NULL, path=NULL, scale=1, width=NA, height=NA, dpi=300, limitsize=TRUE)
p <- ggplot(ghg, aes(x=soiltemp, y=log(co2.mgm2hr), color=as.factor(hydrology))) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor =element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "black",size=1)) + scale_color_manual(name="Hydrology", values=c("darkgray", "blue"), labels = c("shallow (t)", "inundated (w)")) + stat_summary(fun.data=mean_cl_boot,size=1.25, position=position_dodge(width=0.75))
p1=p+geom_smooth(method="lm")+facet_wrap(~placement)
p1 + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, size=14), panel.border = element_rect(colour = "black",size=1)) + theme(axis.ticks.length=unit(0.3,"cm")) + labs(x = "Soil Temperature (°C) ", y =  (expression(paste("log CO"[2]," flux (mg m"^-{2},"hr"^-{1},")")))) + theme(strip.text.x = element_text(size=16, face="bold"), strip.text.y = element_text(size=16, face="bold"), strip.background = element_rect(colour="black", fill="white", size=1))+theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14))
ggsave("../figures/carbondioxide.pdf", plot=last_plot(), device=NULL, path=NULL, scale=1, width=NA, height=NA, dpi=300, limitsize=TRUE)
p <- ggplot(ghg, aes(x=soiltemp, y=log(ch4.mgm2hr), color=as.factor(hydrology))) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor =element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "black",size=1)) + scale_color_manual(name="Hydrology", values=c("darkgray", "blue"), labels = c("shallow (t)", "inundated (w)")) + stat_summary(fun.data=mean_cl_boot,size=1.25, position=position_dodge(width=0.75))
p1=p+geom_smooth(method="lm")+facet_wrap(~placement)
p1 + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, size=14), panel.border = element_rect(colour = "black",size=1)) + theme(axis.ticks.length=unit(0.3,"cm")) + labs(x = "Soil Temperature (°C) ", y =  (expression(paste("log CH"[4]," flux (mg m"^-{2},"hr"^-{1},")")))) + theme(strip.text.x = element_text(size=16, face="bold"), strip.text.y = element_text(size=16, face="bold"), strip.background = element_rect(colour="black", fill="white", size=1))+theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14))
ggsave("../figures/methane.pdf", plot=last_plot(), device=NULL, path=NULL, scale=1, width=NA, height=NA, dpi=300, limitsize=TRUE)
p <- ggplot(ghg, aes(x=soiltemp, y=log(n2o.mgm2hr), color=as.factor(hydrology))) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor =element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "black",size=1)) + scale_color_manual(name="Hydrology", values=c("darkgray", "blue"), labels = c("shallow (t)", "inundated (w)")) + stat_summary(fun.data=mean_cl_boot,size=1.25, position=position_dodge(width=0.75))
#linear models for CH4
n2o.lm <- lm(log(n2o.mgm2hr)~soiltemp*hydrology*placement, data=ghg)
plot(n2o.lm)
p <- ggplot(ghg, aes(x=soiltemp, y=log(n2o.mgm2hr), color=as.factor(hydrology))) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor =element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "black",size=1)) + scale_color_manual(name="Hydrology", values=c("darkgray", "blue"), labels = c("shallow (t)", "inundated (w)")) + stat_summary(fun.data=mean_cl_boot,size=1.25, position=position_dodge(width=0.75))
p1=p+geom_smooth(method="lm")+facet_wrap(~placement)
p1 + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, size=14), panel.border = element_rect(colour = "black",size=1)) + theme(axis.ticks.length=unit(0.3,"cm")) + labs(x = "Soil Temperature (°C) ", y =  (expression(paste("log","N"[2],"O"," flux (mg m"^-{2},"hr"^-{1},")")))) + theme(strip.text.x = element_text(size=16, face="bold"), strip.text.y = element_text(size=16, face="bold"), strip.background = element_rect(colour="black", fill="white", size=1))+theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14))
p <- ggplot(ghg, aes(x=soiltemp, y=log(n2o.mgm2hr), color=as.factor(hydrology))) + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor =element_blank(), axis.line = element_line(colour = "black"), panel.border = element_rect(colour = "black",size=1)) + scale_color_manual(name="Hydrology", values=c("darkgray", "blue"), labels = c("shallow (t)", "inundated (w)")) + stat_summary(fun.data=mean_cl_boot,size=1.25, position=position_dodge(width=0.75))
p1=p+geom_smooth(method="lm")+facet_wrap(~placement)
p1 + theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14), axis.text.x = element_text(vjust=0.65, hjust=0.5, size=14), panel.border = element_rect(colour = "black",size=1)) + theme(axis.ticks.length=unit(0.3,"cm")) + labs(x = "Soil Temperature (°C) ", y =  (expression(paste("log ","N"[2],"O"," flux (mg m"^-{2},"hr"^-{1},")")))) + theme(strip.text.x = element_text(size=16, face="bold"), strip.text.y = element_text(size=16, face="bold"), strip.background = element_rect(colour="black", fill="white", size=1))+theme(axis.title=element_text(vjust=1,size=16,face="bold"), axis.text=element_text(size=14))
ggsave("../figures/nitrousoxide.pdf", plot=last_plot(), device=NULL, path=NULL, scale=1, width=NA, height=NA, dpi=300, limitsize=TRUE)
