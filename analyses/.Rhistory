outlierTest(ch4.lm)
require(nlme)
ghg$logch4 <- log(ghg$ch4cmgm2day)
ch4.lm <- lm(logch4~hydrology*season, random=~1|sampleid/hydrology, data=ghg)
plot(ch4.lm)
anova(ch4.lm)
summary(ch4.lm)
require(car)
outlierTest(ch4.lm)
leveragePlots(ch4.lm)
# Normality of Residuals
# qq plot for studentized resid
qqPlot(ch4.lm, main="QQ Plot")
#I log used the log to help with normality
require(nlme)
ghg$logch4 <- log(ghg$ch4cmgm2day)
ch4.lm <- lm(logch4~hydrology*season, random=~1|sampleid/hydrology, data=ghg)
plot(ch4.lm)
ch4.lm <- lm(logch4~hydrology*season, random=~1|sampleid/hydrology, data=ghg)
plot(ch4.lm)
anova(ch4.lm)
summary(ch4.lm)
outlierTest(ch4.lm)
leveragePlots(ch4.lm)
# Normality of Residuals
# qq plot for studentized resid
qqPlot(ch4.lm, main="QQ Plot")
leveragePlots(ch4.lm)
outlierTest(ch4.lm)
require(MASS)
sresid <- studres(ch4.lm)
hist(sresid, freq=FALSE,
main="Distribution of Studentized Residuals")
xfit<-seq(min(sresid),max(sresid),length=40)
yfit<-dnorm(xfit)
lines(xfit, yfit)
#Which environmental parameters help explain ghg production?
#Have monthly water values that correspond to PI chambers 1w-5w
#Have sediment values for 4 timepoints (May, Aug, Oct, Dec)
#I log used the log to help with normality
require(nlme)
ghg$logch4 <- log(ghg$ch4cmgm2day)
ch4.lm <- lm(ch4cmgm2day~hydrology*season, random=~1|sampleid/hydrology, data=ghg)
plot(ch4.lm)
anova(ch4.lm)
summary(ch4.lm)
require(car)
outlierTest(ch4.lm)
leveragePlots(ch4.lm)
# Normality of Residuals
# qq plot for studentized resid
qqPlot(ch4.lm, main="QQ Plot")
# distribution of studentized residuals
require(MASS)
sresid <- studres(ch4.lm)
hist(sresid, freq=FALSE,
main="Distribution of Studentized Residuals")
xfit<-seq(min(sresid),max(sresid),length=40)
yfit<-dnorm(xfit)
lines(xfit, yfit)
#Which environmental parameters help explain ghg production?
#Have monthly water values that correspond to PI chambers 1w-5w
#Have sediment values for 4 timepoints (May, Aug, Oct, Dec)
#I log used the log to help with normality
require(nlme)
ghg$logch4 <- log(ghg$ch4cmgm2day)
ch4.lm <- lm(logch4~hydrology*season, random=~1|sampleid/hydrology, data=ghg)
plot(ch4.lm)
anova(ch4.lm)
summary(ch4.lm)
require(car)
outlierTest(ch4.lm)
leveragePlots(ch4.lm)
# Normality of Residuals
# qq plot for studentized resid
qqPlot(ch4.lm, main="QQ Plot")
# distribution of studentized residuals
require(MASS)
sresid <- studres(ch4.lm)
hist(sresid, freq=FALSE,
main="Distribution of Studentized Residuals")
xfit<-seq(min(sresid),max(sresid),length=40)
yfit<-dnorm(xfit)
lines(xfit, yfit)
View(design)
ch4.lm <- lm(logch4~hydrology*season+distanc.m, random=~1|sampleid/hydrology, data=ghg)
View(design)
View(ghg)
View(ghg)
View(ghg)
ch4.lm <- lm(logch4~hydrology*season+distance.m, random=~1|sampleid/hydrology, data=ghg)
ch4.lm <- lm(logch4~hydrology*season+distance.m, random=~1|sampleid/hydrology, data=ghg)
ch4.lm <- lm(logch4~hydrology*season+distance.m, random=~1|sampleid/hydrology, data=ghg)
plot(ch4.lm)
anova(ch4.lm)
summary(ch4.lm)
ch4.lm <- lm(logch4~hydrology*season+distance.m+num.days.last.rain+water.depth, random=~1|sampleid/hydrology, data=ghg)
ch4.lm <- lm(logch4~hydrology*season+distance.m+num.days.last.rain.+water.depth, random=~1|sampleid/hydrology, data=ghg)
ch4.lm <- lm(logch4~hydrology*season+distance.m+num.days.last.rain.+water.depth.cm, random=~1|sampleid/hydrology, data=ghg)
plot(ch4.lm)
anova(ch4.lm)
summary(ch4.lm)
ghg.soil <- ghg %>%
filter(month=="5-May" | "7-Jul" | "10-Oct", "12-Dec")
ghg.soil <- ghg %>%
filter(month=="5-May" | "7-Jul" | "10-Oct"| "12-Dec")
ghg.soil <- ghg %>%
filter(month==c("5-May","7-Jul","10-Oct", "12-Dec"))
View(ghg.soil)
ghg.soil <- ghg %>%
filter(month==c("5-May","7-Jul","10-Oct", "12-Dec"))
ghg.soil <- ghg %>%
filter(month==c("5-May"))
ghg.soil <- ghg %>%
filter(month==c("5-May","7-Jul"))
ghg.soil <- ghg %>%
filter(month==c("5-May","7-Jul"))
View(ghg.soil)
View(ghg)
ghg.soil <- ghg %>%
filter(date==c("1/17/2017"))
ghg.soil <- ghg %>%
filter(date==c("5/18/2017"))
ghg.soil <- ghg %>%
filter(date==c("5/18/2017", "7/26/2017"))
ghg.soil <- ghg %>%
filter(date=="5/18/2017" | date=="7/26/2017")
ghg.soil <- ghg %>%
filter(date=="5/18/2017" | date=="7/26/2017" | date=="10/18/2017" | date=="12/14/2017")
View(ghg.soil)
ch4.lm <- lm(logch4~hydrology*season+moist.percent+ph+om.percent+nh4n.mg.gdw+no3n.mg.gdw+c.percent+n.percent+ c.n, random=~1|sampleid/hydrology, data=ghg.soil)
plot(ch4.lm)
anova(ch4.lm)
ch4.lm1 <- lm(logch4~hydrology*season, random=~1|sampleid/hydrology, data=gh.gsoil)
#Which environmental parameters help explain ghg production?
#Have monthly water values that correspond to PI chambers 1w-5w
#Have sediment values for 4 timepoints (May, Aug, Oct, Dec)
#I log used the log to help with normality
ghg$logch4 <- log(ghg$ch4cmgm2day)
ghg.soil <- ghg %>%
filter(date=="5/18/2017" | date=="7/26/2017" | date=="10/18/2017" | date=="12/14/2017")
ch4.lm1 <- lm(logch4~hydrology*season, random=~1|sampleid/hydrology, data=ghg.soil)
plot(ch4.lm)
anova(ch4.lm)
ch4.lm2 <- lm(logch4~hydrology*season+moist.percent+ph+om.percent+nh4n.mg.gdw+no3n.mg.gdw+c.percent+n.percent+ c.n, random=~1|sampleid/hydrology, data=ghg.soil)
plot(ch4.lm)
anova(ch4.lm)
ch4.lm3 <- lm(logch4~hydrology*season+moist.percent+ph+om.percent+nh4n.mg.gdw+no3n.mg.gdw+c.percent+n.percent, random=~1|sampleid/hydrology, data=ghg.soil)
plot(ch4.lm)
anova(ch4.lm)
ch4.lm4 <- lm(logch4~hydrology*season+moist.percent+ph+om.percent+nh4n.mg.gdw+no3n.mg.gdw+c.percent, random=~1|sampleid/hydrology, data=ghg.soil)
plot(ch4.lm)
anova(ch4.lm)
ch4.lm5 <- lm(logch4~hydrology*season+moist.percent+ph+om.percent+nh4n.mg.gdw+no3n.mg.gdw, random=~1|sampleid/hydrology, data=ghg.soil)
plot(ch4.lm)
anova(ch4.lm)
ch4.lm6 <- lm(logch4~hydrology*season+moist.percent+ph+om.percent+nh4n.mg.gdw, random=~1|sampleid/hydrology, data=ghg.soil)
plot(ch4.lm)
anova(ch4.lm)
ch4.lm7 <- lm(logch4~hydrology*season+moist.percent+ph+om.percent, random=~1|sampleid/hydrology, data=ghg.soil)
plot(ch4.lm)
anova(ch4.lm)
ch4.lm8 <- lm(logch4~hydrology*season+moist.percent+ph, random=~1|sampleid/hydrology, data=ghg.soil)
plot(ch4.lm)
anova(ch4.lm)
ch4.lm9 <- lm(logch4~hydrology*season+moist.percent, random=~1|sampleid/hydrology, data=ghg.soil)
plot(ch4.lm)
anova(ch4.lm)
ch4.lm10 <- lm(logch4~hydrology*season+distance.m+num.days.last.rain.+water.depth.cm, random=~1|sampleid/hydrology, data=ghg.soil)
plot(ch4.lm)
anova(ch4.lm)
BIC(ch4.lm1, ch4.lm2, ch4.lm3, ch4.lm4, ch4.lm5, ch4.lm6, ch4.lm7, ch4.lm8, ch4.lm9, ch4.lm10)
outlierTest(ch4.lm)
leveragePlots(ch4.lm)
# Normality of Residuals
# qq plot for studentized resid
qqPlot(ch4.lm, main="QQ Plot")
# distribution of studentized residuals
require(MASS)
sresid <- studres(ch4.lm)
hist(sresid, freq=FALSE,
main="Distribution of Studentized Residuals")
xfit<-seq(min(sresid),max(sresid),length=40)
yfit<-dnorm(xfit)
lines(xfit, yfit)
BIC(ch4.lm1, ch4.lm2, ch4.lm3, ch4.lm4, ch4.lm5, ch4.lm6, ch4.lm7, ch4.lm8, ch4.lm9, ch4.lm10)
AIC(ch4.lm1, ch4.lm2, ch4.lm3, ch4.lm4, ch4.lm5, ch4.lm6, ch4.lm7, ch4.lm8, ch4.lm9, ch4.lm10)
BIC(ch4.lm1, ch4.lm2, ch4.lm3, ch4.lm4, ch4.lm5, ch4.lm6, ch4.lm7, ch4.lm8, ch4.lm9, ch4.lm10)
ch4.lm1 <- lme(logch4~hydrology*season, random=~1|sampleid/hydrology, data=ghg.soil)
ch4.lm1 <- lme(logch4~hydrology*season, random=~1|sampleid, data=ghg.soil)
ch4.lm1 <- lm(logch4~hydrology*season, random=~1|sampleid/hydrology, data=ghg.soil)
ch4.lm1 <- lm(logch4~hydrology*season, random=~1|sampleid/hydrology, data=ghg.soil)
ch4.lm1 <- lmer(logch4~hydrology*season, random=~1|sampleid/hydrology, data=ghg.soil)
require("lme4")
ch4.lm1 <- lmer(logch4~hydrology*season + (1|sampleid/hydrology, data=ghg.soil)
ch4.lm1 <- lmer(logch4~hydrology*season + (1|sampleid/hydrology), data=ghg.soil)
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
ch4.lm1 <- lmer(logch4~hydrology*season + (1|sampleid), data=ghg.soil)
ch4.lm1 <- lmer(logch4~hydrology*season + (1|sampleid), data=ghg.soil)
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
BIC(ch4.lm1, ch4.lm2, ch4.lm3, ch4.lm4, ch4.lm5, ch4.lm6, ch4.lm7, ch4.lm8, ch4.lm9, ch4.lm10)
ch4.lm1 <- lmer(logch4~hydrology*season + (1|sampleid), data=ghg.soil)
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
ch4.lm1 <- lmer(logch4~hydrology*season + (1|sampleid), data=ghg.soil)
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
ch4.lm2 <- lmer(logch4~hydrology*season+moist.percent+ph+om.percent+nh4n.mg.gdw+no3n.mg.gdw+c.percent+n.percent+ c.n + (~1|sampleid), data=ghg.soil)
ch4.lm2 <- lmer(logch4~hydrology*season+moist.percent+ph+om.percent+nh4n.mg.gdw+no3n.mg.gdw+c.percent+n.percent+ c.n + (1|sampleid), data=ghg.soil)
plot(ch4.lm)
anova(ch4.lm)
ch4.lm2 <- lmer(logch4~hydrology*season+moist.percent+ph+om.percent+nh4n.mg.gdw+no3n.mg.gdw+c.percent+n.percent+ c.n + (1|sampleid), data=ghg.soil)
plot(ch4.lm2)
anova(ch4.lm2)
summary(ch4.lm2)
qqnorm(resid(ch4.lm1))
# Normality of Residuals
# qq plot for studentized resid
qqPlot(resid(ch4.lm1), main="QQ Plot")
ch4.lm1 <- lmer(ch4cmgm2day~hydrology*season + (1|sampleid), data=ghg.soil)
qqPlot(resid(ch4.lm1), main="QQ Plot")
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
ch4.lm1 <- lmer(logch4~hydrology*season + (1|sampleid), data=ghg.soil)
anova(ch4.lm1)
summary(ch4.lm1)
qqnorm(resid(ch4.lm1))
ch4.lm1 <- lmer(logch4~hydrology*season + (1|sampleid), data=ghg.soil)
qqnorm(resid(ch4.lm1))
ch4.lm1 <- lmer(ch4cmgm2day~hydrology*season + (1|sampleid), data=ghg.soil)
qqnorm(resid(ch4.lm1))
qqPlot(resid(ch4.lm1), main="QQ Plot")
shapiro.test(resid(ch4.lm1))
ch4.lm1 <- lmer(ch4cmgm2day~hydrology*season + (1|sampleid), data=ghg.soil, REML=FALSE)
qqnorm(resid(ch4.lm1))
anova(ch4.lm1)
summary(ch4.lm1)
ch4.lm1 <- lmer(ch4cmgm2day~hydrology*season, data=ghg.soil, REML=FALSE)
ch4.lm1 <- lm(ch4cmgm2day~hydrology*season, data=ghg.soil, REML=FALSE)
qqnorm(resid(ch4.lm1))
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
ch4.lm1 <- lm(ch4cmgm2day~hydrology*season+1|sampleid/hydrology, data=ghg.soil, REML=FALSE)
ch4.lm1 <- lm(ch4cmgm2day~hydrology*season+(1|sampleid/hydrology), data=ghg.soil, REML=FALSE)
qqnorm(resid(ch4.lm1))
anova(ch4.lm1)
summary(ch4.lm1)
ch4.lm1 <- lm(ch4cmgm2day~hydrology*season+(1|sampleid), data=ghg.soil, REML=FALSE)
ch4.lm1 <- lmer(ch4cmgm2day~hydrology*season+(1|sampleid), data=ghg.soil, REML=FALSE)
qqnorm(resid(ch4.lm1))
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
ch4.lm1 <- lmer(logch4~hydrology*season+(1|sampleid), data=ghg.soil, REML=FALSE)
qqnorm(resid(ch4.lm1))
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
ch4.lm1 <- lm(logch4~hydrology*season+(1|sampleid), data=ghg.soil, REML=FALSE)
View(design)
View(ghg)
View(ghg.soil)
View(ghg.soil)
ch4.lm1 <- lmer(logch4~hydrology*avg.temp.c+(1|sampleid), data=ghg.soil, REML=FALSE)
qqnorm(resid(ch4.lm1))
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
ch4.lm1 <- lmer(logch4~hydrology*season+avg.temp.c+(1|sampleid), data=ghg.soil, REML=FALSE)
qqnorm(resid(ch4.lm1))
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
ch4.lm1 <- lm(logch4~hydrology*season+avg.temp.c, data=ghg.soil, REML=FALSE)
qqnorm(resid(ch4.lm1))
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
ch4.lm1 <- lm(ch4cmgm2day~hydrology*season+avg.temp.c, data=ghg.soil, REML=FALSE)
qqnorm(resid(ch4.lm1))
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
ch4.lm1 <- lmer(ch4cmgm2day~hydrology*season+avg.temp.c+(1|sampleid), data=ghg.soil, REML=FALSE)
qqnorm(resid(ch4.lm1))
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
ch4.lm1 <- lmer(ch4cmgm2day~hydrology*season+distance.m+avg.temp.c+(1|sampleid), data=ghg.soil, REML=FALSE)
qqnorm(resid(ch4.lm1))
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
ch4.lm1 <- lmer(ch4cmgm2day~hydrology*season+distance.m+avg.temp.c+(1|sampleid)+(1|date), data=ghg.soil, REML=FALSE)
qqnorm(resid(ch4.lm1))
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
ch4.lm1 <- lmer(ch4cmgm2day~hydrology*season+distance.m+avg.temp.c+(1|sampleid)+(1|date), data=ghg.soil, REML=FALSE)
qqnorm(resid(ch4.lm1))
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
ch4.lm1 <- lmer(ch4cmgm2day~hydrology+distance.m+avg.temp.c+(1|sampleid)+(1|season), data=ghg.soil, REML=FALSE)
qqnorm(resid(ch4.lm1))
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
ch4.lm1 <- lmer(ch4cmgm2day~hydrology*date+distance.m+avg.temp.c+(1|sampleid), data=ghg.soil, REML=FALSE)
qqnorm(resid(ch4.lm1))
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
ch4.lm1 <- lm(ch4cmgm2day~hydrology*season+distance.m+avg.temp.c, data=ghg.soil, REML=FALSE)
qqnorm(resid(ch4.lm1))
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
ch4.lm1 <- lm(ch4cmgm2day~hydrology*distance.m+avg.temp.c, data=ghg.soil, REML=FALSE)
qqnorm(resid(ch4.lm1))
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
ch4.lm1 <- lm(ch4cmgm2day~hydrology*distance.m+avg.temp.c, data=ghg.soil, REML=FALSE)
qqnorm(resid(ch4.lm1))
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
qqPlot(resid(ch4.lm1), main="QQ Plot")
qqPlot(resid(ch4.lm1), main="QQ Plot")
# distribution of studentized residuals
require(MASS)
sresid <- studres(ch4.lm)
hist(sresid, freq=FALSE,
main="Distribution of Studentized Residuals")
xfit<-seq(min(sresid),max(sresid),length=40)
yfit<-dnorm(xfit)
lines(xfit, yfit)
ghg$sqch4 <- ghg$ch4cmgm2day^2
ch4.lm1 <- lm(sqch4~hydrology*distance.m+avg.temp.c, data=ghg.soil, REML=FALSE)
ghg$logch4 <- log(ghg$ch4cmgm2day)
ghg$sqch4 <- ghg$ch4cmgm2day^2
ghg.soil <- ghg %>%
filter(date=="5/18/2017" | date=="7/26/2017" | date=="10/18/2017" | date=="12/14/2017")
ch4.lm1 <- lm(sqch4~hydrology*distance.m+avg.temp.c, data=ghg.soil, REML=FALSE)
qqnorm(resid(ch4.lm1))
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
ghg$sqch4 <- sqrt(ghg$ch4cmgm2day)
ghg$logch4 <- log(ghg$ch4cmgm2day)
ghg$sqch4 <- sqrt(ghg$ch4cmgm2day)
ghg.soil <- ghg %>%
filter(date=="5/18/2017" | date=="7/26/2017" | date=="10/18/2017" | date=="12/14/2017")
ch4.lm1 <- lm(sqch4~hydrology*distance.m+avg.temp.c, data=ghg.soil, REML=FALSE)
qqnorm(resid(ch4.lm1))
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
qqPlot(resid(ch4.lm1), main="QQ Plot")
qqnorm(resid(ch4.lm1))
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
ggplot(aes(x=distance.m, y=ch4cmgm2day, data=ghg.saoil))+geom_point()
ggplot(aes(x=distance.m, y=ch4cmgm2day, data=ghg.soil))+geom_point()
ggplot(aes(x=distance.m, y=ch4cmgm2day), data=ghg.soil))+geom_point()
ggplot(aes(x=distance.m, y=ch4cmgm2day), data=ghg.soil)+geom_point()
ggplot(aes(x=distance.m, y=ch4cmgm2day, color=hydrology), data=ghg.soil)+geom_point()
ggplot(aes(x=distance.m, y=ch4cmgm2day, color=hydrology), data=ghg.soil)+geom_point()
ggplot(aes(x=water.depth, y=ch4cmgm2day, color=hydrology), data=ghg.soil)+geom_point()
View(ghg.soil)
ggplot(aes(x=water.depth.cm, y=ch4cmgm2day, color=hydrology), data=ghg.soil)+geom_point()
distance.m
ggplot(aes(x=distance.m, y=ch4cmgm2day, color=hydrology), data=ghg.soil)+geom_point()
ggplot(aes(x=water.depth.cm, y=ch4cmgm2day, color=hydrology), data=ghg.soil)+geom_point()
ggplot(aes(x=distance.m, y=ch4cmgm2day, color=hydrology), data=ghg.soil)+geom_point()
ch4.lm2 <- lmer(sqch4~hydrology*season+moist.percent+ph+om.percent+nh4n.mg.gdw+no3n.mg.gdw+c.percent+n.percent+ c.n + (1|sampleid), data=ghg.soil)
plot(ch4.lm2)
anova(ch4.lm2)
summary(ch4.lm2)
ch4.lm1 <- lm(ch4cmgm2day~hydrology*distance.m+avg.temp.c, data=ghg.soil)
ch4.lm1 <- lm(ch4cmgm2day~hydrology*distance.m+avg.temp.c, data=ghg.soil)
qqPlot(resid(ch4.lm1), main="QQ Plot")
shapiro.test(resid(ch4.lm1))
require(MASS)
sresid <- studres(ch4.lm)
hist(sresid, freq=FALSE,
main="Distribution of Studentized Residuals")
xfit<-seq(min(sresid),max(sresid),length=40)
yfit<-dnorm(xfit)
lines(xfit, yfit)
sresid <- studres(ch4.lm1)
hist(sresid, freq=FALSE,
main="Distribution of Studentized Residuals")
xfit<-seq(min(sresid),max(sresid),length=40)
yfit<-dnorm(xfit)
lines(xfit, yfit)
#Normaility test
qqPlot(resid(ch4.lm1), main="QQ Plot")
ghg.soil <- ghg %>%
filter(date=="5/18/2017" | date=="7/26/2017" | date=="10/18/2017" | date=="12/14/2017")
#Which design and sediment variables best predict GHG fluxes?
#hydrology and distance.m from inlet are main parameters of interest
ggplot(aes(x=distance.m, y=ch4cmgm2day, color=hydrology), data=ghg.soil)+geom_point()
ch4.lm1 <- lm(ch4cmgm2day~hydrology*distance.m+avg.temp.c, data=ghg.soil)
#Normaility test
qqPlot(resid(ch4.lm1), main="QQ Plot")
shapiro.test(resid(ch4.lm1))
require(MASS)
sresid <- studres(ch4.lm1)
hist(sresid, freq=FALSE,
main="Distribution of Studentized Residuals")
xfit<-seq(min(sresid),max(sresid),length=40)
yfit<-dnorm(xfit)
lines(xfit, yfit)
ghg$sqch4 <- sqrt(ghg$ch4cmgm2day)
#Check model
ch4.lm1 <- lm(sqch4~hydrology*distance.m+avg.temp.c, data=ghg.soil)
#Normaility test
qqPlot(resid(ch4.lm1), main="QQ Plot")
shapiro.test(resid(ch4.lm1))
sresid <- studres(ch4.lm1)
hist(sresid, freq=FALSE,
main="Distribution of Studentized Residuals")
xfit<-seq(min(sresid),max(sresid),length=40)
yfit<-dnorm(xfit)
lines(xfit, yfit)
qqnorm(resid(ch4.lm1))
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
resid <- resid(ch4.lm1)
hist(sresid, freq=FALSE,
main="Distribution of Residuals")
xfit<-seq(min(resid),max(resid),length=40)
yfit<-dnorm(xfit)
lines(xfit, yfit)
#Which environmental parameters help explain GHG production?
#Also have monthly water values that correspond to PI chambers 1w-5w
#First sediment parameters. There are GHG fluxes and sediment properties for 4 timepoints (May, Aug, Oct, Dec)
#Filter ghg dataset to include only sampling points with soil variables
ghg.soil <- ghg %>%
filter(date=="5/18/2017" | date=="7/26/2017" | date=="10/18/2017" | date=="12/14/2017")
#Which design and sediment variables best predict GHG fluxes?
#hydrology and distance.m from inlet are main parameters of interest
ggplot(aes(x=distance.m, y=ch4cmgm2day, color=hydrology), data=ghg.soil)+geom_point()
ch4.lm1 <- lm(ch4cmgm2day~hydrology*distance.m+avg.temp.c, data=ghg.soil)
#Normaility test
qqPlot(resid(ch4.lm1), main="QQ Plot")
shapiro.test(resid(ch4.lm1))
sresid <- resid(ch4.lm1)
hist(sresid, freq=FALSE,
main="Distribution of Residuals")
xfit<-seq(min(sresid),max(sresid),length=40)
yfit<-dnorm(xfit)
lines(xfit, yfit)
#Square root transformation to help with normality
ghg$sqch4 <- sqrt(ghg$ch4cmgm2day)
#Check model
ch4.lm1 <- lm(sqch4~hydrology*distance.m+avg.temp.c, data=ghg.soil)
#Normaility test
qqPlot(resid(ch4.lm1), main="QQ Plot")
shapiro.test(resid(ch4.lm1))
sresid <- resid(ch4.lm1)
hist(sresid, freq=FALSE,
main="Distribution of Residuals")
xfit<-seq(min(sresid),max(sresid),length=40)
yfit<-dnorm(xfit)
lines(xfit, yfit)
plot(ch4.lm1)
anova(ch4.lm1)
summary(ch4.lm1)
ch4.lm2 <- lmer(sqch4~hydrology*season+moist.percent+ph+om.percent+nh4n.mg.gdw+no3n.mg.gdw+c.percent+n.percent+ c.n + (1|sampleid), data=ghg.soil, REML=FALSE)
plot(ch4.lm2)
anova(ch4.lm2)
summary(ch4.lm2)
ch4.lm3 <- lm(logch4~hydrology*season+moist.percent+ph+om.percent+nh4n.mg.gdw+no3n.mg.gdw+c.percent+n.percent, random=~1|sampleid/hydrology, data=ghg.soil)
plot(ch4.lm)
anova(ch4.lm)
ch4.lm4 <- lm(logch4~hydrology*season+moist.percent+ph+om.percent+nh4n.mg.gdw+no3n.mg.gdw+c.percent, random=~1|sampleid/hydrology, data=ghg.soil)
plot(ch4.lm)
anova(ch4.lm)
ch4.lm5 <- lm(logch4~hydrology*season+moist.percent+ph+om.percent+nh4n.mg.gdw+no3n.mg.gdw, random=~1|sampleid/hydrology, data=ghg.soil)
plot(ch4.lm)
anova(ch4.lm)
ch4.lm6 <- lm(logch4~hydrology*season+moist.percent+ph+om.percent+nh4n.mg.gdw, random=~1|sampleid/hydrology, data=ghg.soil)
plot(ch4.lm)
anova(ch4.lm)
ch4.lm7 <- lm(logch4~hydrology*season+moist.percent+ph+om.percent, random=~1|sampleid/hydrology, data=ghg.soil)
plot(ch4.lm)
anova(ch4.lm)
ch4.lm8 <- lm(logch4~hydrology*season+moist.percent+ph, random=~1|sampleid/hydrology, data=ghg.soil)
plot(ch4.lm)
anova(ch4.lm)
ch4.lm9 <- lm(logch4~hydrology*season+moist.percent, random=~1|sampleid/hydrology, data=ghg.soil)
plot(ch4.lm)
anova(ch4.lm)
ch4.lm10 <- lm(logch4~hydrology*season+distance.m+num.days.last.rain.+water.depth.cm, random=~1|sampleid/hydrology, data=ghg.soil)
plot(ch4.lm)
anova(ch4.lm)
BIC(ch4.lm1, ch4.lm2, ch4.lm3, ch4.lm4, ch4.lm5, ch4.lm6, ch4.lm7, ch4.lm8, ch4.lm9, ch4.lm10)
outlierTest(ch4.lm)
leveragePlots(ch4.lm)
